const e="/api/xauth";export default{initiateXAuth:async function(r){try{const t=await fetch(`${e}/auth-url?avatarId=${r}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(404===t.status)return console.error("X auth API endpoint not found. Server may not support X integration yet."),{success:!1,error:"X integration is not available on this server."};if(!t.ok){const e=t.headers.get("content-type");let r;if(e&&e.includes("application/json"))try{r=(await t.json()).error||`Server error: ${t.status}`}catch(e){r=`Failed to parse error response: ${e.message}`}else r=`Server returned: ${t.status} ${t.statusText}`;return{success:!1,error:r}}const s=await t.json();if(s.url){const e=600,r=600,t=(window.innerWidth-e)/2,o=(window.innerHeight-r)/2,n=window.open(s.url,"xAuth",`width=${e},height=${r},top=${o},left=${t}`);return!n||n.closed||void 0===n.closed?{success:!1,error:"Popup blocked. Please allow popups for this site."}:{success:!0,popup:n}}return{success:!1,error:"No authorization URL provided by the server."}}catch(e){return console.error("Error initiating X auth:",e),{success:!1,error:e.message||"An unknown error occurred connecting to the server."}}},disconnectXAuth:async function(r){try{const t=await fetch(`${e}/disconnect/${r}`,{method:"POST",headers:{"Content-Type":"application/json"}});if(404===t.status)return console.error("X auth disconnect endpoint not found. Server may not support X integration yet."),{success:!1,error:"X integration is not available on this server."};if(!t.ok){const e=t.headers.get("content-type");let r;if(e&&e.includes("application/json"))try{r=(await t.json()).error||`Server error: ${t.status}`}catch(e){r=`Failed to parse error response: ${e.message}`}else r=`Server returned: ${t.status} ${t.statusText}`;return{success:!1,error:r}}try{return{success:!0,message:(await t.json()).message||"X account disconnected successfully."}}catch(e){return console.error("Failed to parse JSON response:",e),{success:!1,error:"Invalid response from server."}}}catch(e){return console.error("Error disconnecting X auth:",e),{success:!1,error:e.message||"An unknown error occurred connecting to the server."}}}};