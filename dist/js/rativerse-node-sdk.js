import http from"http";import https from"https";class RATiVerseClient{constructor(t){this.baseUrl=new URL(t.baseUrl),this.apiKey=t.apiKey}async _request(t,e,r=null){return new Promise(((s,a)=>{const n={hostname:this.baseUrl.hostname,port:this.baseUrl.port||("https:"===this.baseUrl.protocol?443:80),path:e.startsWith("/")?e:`/${e}`,method:t,headers:{"Content-Type":"application/json"}};this.apiKey&&(n.headers.Authorization=`Bearer ${this.apiKey}`),r&&(r=JSON.stringify(r),n.headers["Content-Length"]=Buffer.byteLength(r));const o=("https:"===this.baseUrl.protocol?https:http).request(n,(t=>{let e="";t.on("data",(t=>{e+=t})),t.on("end",(()=>{if(t.statusCode>=200&&t.statusCode<300)try{s(JSON.parse(e))}catch(t){a(new Error(`Failed to parse response: ${t.message}`))}else try{const r=JSON.parse(e);a(new Error(`API Error (${t.statusCode}): ${r.error||"Unknown error"}`))}catch(e){a(new Error(`API Error (${t.statusCode}): Unknown error`))}}))}));o.on("error",(t=>{a(new Error(`Request failed: ${t.message}`))})),r&&o.write(r),o.end()}))}async getAllAvatars(){return this._request("GET","/api/avatars")}async getAvatar(t){return this._request("GET",`/api/avatars/${t}`)}async getAvatarMemory(t){return this._request("GET",`/api/avatars/${t}/memory`)}async getAllItems(){return this._request("GET","/api/items")}async getItem(t){return this._request("GET",`/api/items/${t}`)}async getAllLocations(){return this._request("GET","/api/locations")}async getLocation(t){return this._request("GET",`/api/locations/${t}`)}async getAvatarsInLocation(t){return this._request("GET",`/api/locations/${t}/avatars`)}async chatWithAvatar(t){return this._request("POST","/api/chat",t)}}module.exports={RATiVerseClient};