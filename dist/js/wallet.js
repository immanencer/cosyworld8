const walletState={wallet:null};function shortenAddress(t){return t.slice(0,6)+"..."+t.slice(-4)}function updateWalletUI(){const t=document.querySelector(".wallet-container");walletState.wallet?t.innerHTML=`<button class="px-4 py-2 bg-blue-600 text-white rounded">Wallet: ${shortenAddress(walletState.wallet.publicKey)}</button>`:t.innerHTML='<button onclick="connectWallet()" class="px-4 py-2 bg-blue-600 text-white rounded">Connect Wallet</button>'}async function connectWallet(){try{const t=window?.phantom?.solana;if(!t)return void alert("Please install the Phantom wallet extension.");const e=await t.connect();if(!e?.publicKey)throw new Error("No public key received.");walletState.wallet={publicKey:e.publicKey.toString()},updateWalletUI(),"function"==typeof onWalletConnected&&onWalletConnected()}catch(t){console.error("Wallet connection failed:",t),alert("Failed to connect wallet."),walletState.wallet=null,updateWalletUI()}}function disconnectWallet(){walletState.wallet=null,updateWalletUI(),"function"==typeof onWalletDisconnected&&onWalletDisconnected()}document.addEventListener("DOMContentLoaded",(()=>{const t=window?.phantom?.solana;t&&t.connect({onlyIfTrusted:!0}).then((t=>{t?.publicKey&&(walletState.wallet={publicKey:t.publicKey.toString()},updateWalletUI(),"function"==typeof onWalletConnected&&onWalletConnected())})).catch((t=>{console.warn("Auto-connect failed or not trusted:",t)})),updateWalletUI()}));export function initializeWallet(){const t=document.querySelector(".wallet-container");t&&!t.innerHTML.trim()&&(t.innerHTML='<button onclick="connectWallet()" class="px-4 py-2 bg-blue-600 text-white rounded">Connect Wallet</button>');const e=window?.phantom?.solana;e&&e.connect({onlyIfTrusted:!0}).then((e=>{e?.publicKey&&(window.state=window.state||{},window.state.wallet={publicKey:e.publicKey.toString()},function(){const e=window.state?.wallet?.publicKey||"Not connected";t.innerHTML=`<span class="text-white">Wallet: ${e}</span>`}(),window.loadContent&&window.loadContent())})).catch((t=>console.warn("Auto-connect failed:",t)))}