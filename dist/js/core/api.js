import{ENDPOINTS}from"./config.js";import{showToast}from"../utils/toast.js";export async function fetchJSON(t,e={}){try{const o=await fetch(t,e);if(!o.ok){const t=await o.json().catch((()=>null)),e=t?.message||`HTTP error: ${o.status}`;throw new Error(e)}return o.json()}catch(e){throw console.error(`API Error (${t}):`,e),e}}export const AvatarAPI={getAvatars:async(t={})=>{const e=new URLSearchParams(t).toString();return fetchJSON(`${ENDPOINTS.AVATARS}?${e}`)},getAvatarById:t=>fetchJSON(`${ENDPOINTS.AVATARS}/${t}`),getNarratives:t=>fetchJSON(`${ENDPOINTS.AVATARS}/${t}/narratives`),getActions:t=>fetchJSON(`${ENDPOINTS.AVATARS}/${t}/dungeon-actions`),getStats:t=>fetchJSON(`${ENDPOINTS.AVATARS}/${t}/stats`)};export const XAuthAPI={getStatus:t=>fetchJSON(`${ENDPOINTS.XAUTH}/status/${t}`),initiateAuth:(t,e={})=>fetchJSON(`${ENDPOINTS.XAUTH}/initiate/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),disconnect:t=>fetchJSON(`${ENDPOINTS.XAUTH}/disconnect/${t}`,{method:"POST"})};export const ClaimsAPI={getStatus:t=>fetchJSON(`${ENDPOINTS.CLAIMS}/status/${t}`),claimAvatar:(t,e={})=>fetchJSON(`${ENDPOINTS.CLAIMS}/claim/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})};export const TribesAPI={getCounts:()=>fetchJSON(`${ENDPOINTS.TRIBES}/counts`),getTribeByEmoji:t=>fetchJSON(`${ENDPOINTS.TRIBES}/${t}`)};export const DungeonAPI={getActionLog:(t={})=>{const e=new URLSearchParams(t).toString();return fetchJSON(`${ENDPOINTS.DUNGEON}/log?${e}`)}};export const SocialAPI={getPosts:(t={})=>{const e=new URLSearchParams(t).toString();return fetchJSON(`${ENDPOINTS.SOCIAL}/posts?${e}`)}};export const LeaderboardAPI={getLeaderboard:(t={})=>{const e=new URLSearchParams(t).toString();return fetchJSON(`${ENDPOINTS.LEADERBOARD}?${e}`)}};