(self.webpackChunkmoonstone_sanctum=self.webpackChunkmoonstone_sanctum||[]).push([[343],{343:(e,t,a)=>{a.r(t),a.d(t,{loadContent:()=>o});var n=a(903),r=a(318);async function o(){const e=document.getElementById("content");if(e)try{e.innerHTML='\n      <div class="max-w-7xl mx-auto px-4">\n        <h1 class="text-3xl font-bold mb-6">Leaderboard</h1>\n        <div id="leaderboard-items" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"></div>\n        <div id="leaderboard-loader" class="text-center py-8 hidden">\n          <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600 mx-auto"></div>\n          <p class="mt-2 text-gray-400">Loading more avatars...</p>\n        </div>\n      </div>',"leaderboard"===r.wk.activeTab?window.scrollState={page:1,loading:!1,hasMore:!0,initialized:!1}:window.scrollState=window.scrollState||{page:1,loading:!1,hasMore:!0};const t=await n.c3.getLeaderboard({page:1,limit:12}),a=document.getElementById("leaderboard-items"),o=document.getElementById("leaderboard-loader");if(!t.avatars||0===t.avatars.length)return void(a.innerHTML='\n    <div class="col-span-full text-center py-4">\n      <h2 class="text-xl font-bold mb-2">No Leaderboard Data Available</h2>\n      <p class="text-gray-400">Check back later for updated rankings.</p>\n    </div>\n  ');!function(e,t){const{renderLeaderboardCard:a}=window.AvatarDetails||{},n=t.map((e=>`\n    <div onclick="showAvatarDetails('${e._id}')" class="cursor-pointer">\n      ${"function"==typeof a?a(e,e.isClaimed):i(e,e.isClaimed)}\n    </div>\n  `)).join("");e.innerHTML=n}(a,await Promise.all(t.avatars.map((async e=>{try{const t=await n.YJ.getStatus(e._id);return{...e,isClaimed:t.claimed||!1,claimedBy:t.claimedBy||""}}catch(t){return console.warn(`Failed to get claim status for avatar ${e._id}:`,t),{...e,isClaimed:!1,claimedBy:""}}})))),function(e,t){e&&t&&(window.loadMoreLeaderboard=async()=>{if(!window.scrollState.loading&&window.scrollState.hasMore){window.scrollState.loading=!0,e.classList.remove("hidden");try{const a=window.scrollState.page+1,r=await n.c3.getLeaderboard({page:a,limit:12});if(!r.avatars||0===r.avatars.length)return window.scrollState.hasMore=!1,void e.classList.add("hidden");const o=await Promise.all(r.avatars.map((async e=>{try{const t=await n.YJ.getStatus(e._id);return{...e,isClaimed:t.claimed||!1,claimedBy:t.claimedBy||""}}catch(t){return console.warn(`Failed to get claim status for avatar ${e._id}:`,t),{...e,isClaimed:!1,claimedBy:""}}}))),s=document.createDocumentFragment();o.forEach((e=>{const t=document.createElement("div");t.className="cursor-pointer",t.onclick=()=>window.showAvatarDetails(e._id);const{renderLeaderboardCard:a}=window.AvatarDetails||{};t.innerHTML="function"==typeof a?a(e,e.isClaimed):i(e,e.isClaimed),s.appendChild(t)})),t.appendChild(s),window.scrollState.page=a}catch(e){console.error("Failed to load more leaderboard items:",e);const a=document.createElement("div");a.className="col-span-full text-center py-4 text-red-500",a.innerHTML=`\n        Error loading more items: ${e.message}\n        <button class="ml-2 px-3 py-1 bg-blue-600 text-white rounded" onclick="loadMoreLeaderboard()">\n          Retry\n        </button>\n      `,t.appendChild(a)}finally{window.scrollState.loading=!1,window.scrollState.hasMore?e.classList.remove("hidden"):e.classList.add("hidden")}}},new IntersectionObserver((e=>{e[0].isIntersecting&&!window.scrollState.loading&&window.scrollState.hasMore&&window.loadMoreLeaderboard()}),{threshold:.1}).observe(e),e.classList.remove("hidden"))}(o,a)}catch(t){console.error("Load Leaderboard error:",t),e.innerHTML=`\n      <div class="text-center py-12 text-red-500">\n        Failed to load leaderboard: ${t.message}\n        <button class="mt-4 px-4 py-2 bg-primary-600 rounded" onclick="loadContent()">\n          Retry\n        </button>\n      </div>\n    `}}function i(e,t){const a=e=>e?e.includes("gpt-4")?"S":e.includes("gpt-3.5")?"A":e.includes("claude")?"B":"C":"U";return`\n    <div class="avatar-card bg-gray-800 p-3 rounded-lg hover:bg-gray-700 transition-colors ${t?"border-l-2 border-green-500":""}">\n      <div class="flex gap-3 items-center">\n        <div class="relative">\n          <img \n            src="${e.thumbnailUrl||e.imageUrl}" \n            alt="${e.name}" \n            class="w-16 h-16 object-cover rounded-full border-2 border-gray-600"\n            onerror="this.onerror=null; this.src='data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' width=\\'100\\' height=\\'100\\' viewBox=\\'0 0 100 100\\'%3E%3Crect fill=\\'%23333\\' width=\\'100\\' height=\\'100\\'/%3E%3Ctext fill=\\'%23FFF\\' x=\\'50\\' y=\\'50\\' font-size=\\'50\\' text-anchor=\\'middle\\' dominant-baseline=\\'middle\\'%3E${e.name.charAt(0).toUpperCase()}%3C/text%3E%3C/svg%3E';"\n          >\n          ${t?'<div class="absolute -top-1 -right-1 bg-green-500 rounded-full w-5 h-5 flex items-center justify-center text-xs">âœ“</div>':""}\n        </div>\n        \n        <div class="flex-1 min-w-0">\n          <h3 class="text-sm font-semibold truncate">${e.name}</h3>\n          <p class="text-xs text-gray-400">Score: ${e.score||0}</p>\n          \n          <div class="flex items-center gap-2 mt-1">\n            <span class="px-1.5 py-0.5 rounded text-xs font-bold ${(e=>{const t={S:"bg-purple-600",A:"bg-blue-600",B:"bg-green-600",C:"bg-yellow-600",U:"bg-gray-600"};return t[a(e)]||t.U})(e.model)}">\n              Tier ${a(e.model)}\n            </span>\n            ${t?'<span class="text-xs text-green-400">Claimed</span>':""}\n          </div>\n        </div>\n      </div>\n    </div>\n  `}},903:(e,t,a)=>{a.d(t,{D2:()=>i,MD:()=>o,YJ:()=>s,c3:()=>g,cy:()=>c,h5:()=>l,im:()=>d});var n=a(409);async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const a=await fetch(e,t);if(!a.ok){const e=await a.json().catch((()=>null)),t=e?.message||`HTTP error: ${a.status}`;throw new Error(t)}return a.json()}catch(t){throw console.error(`API Error (${e}):`,t),t}}a(522);const o={getAvatars:async function(){const e=new URLSearchParams(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).toString();return r(`${n.Hr.AVATARS}?${e}`)},getAvatarById:e=>r(`${n.Hr.AVATARS}/${e}`),getNarratives:e=>r(`${n.Hr.AVATARS}/${e}/narratives`),getActions:e=>r(`${n.Hr.AVATARS}/${e}/dungeon-actions`),getStats:e=>r(`${n.Hr.AVATARS}/${e}/stats`)},i={getStatus:e=>r(`${n.Hr.XAUTH}/status/${e}`),initiateAuth:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(`${n.Hr.XAUTH}/initiate/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})},disconnect:e=>r(`${n.Hr.XAUTH}/disconnect/${e}`,{method:"POST"})},s={getStatus:e=>r(`${n.Hr.CLAIMS}/status/${e}`),claimAvatar:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(`${n.Hr.CLAIMS}/claim/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}},d={getCounts:()=>r(`${n.Hr.TRIBES}/counts`),getTribeByEmoji:e=>r(`${n.Hr.TRIBES}/${e}`)},l={getActionLog:function(){const e=new URLSearchParams(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).toString();return r(`${n.Hr.DUNGEON}/log?${e}`)}},c={getPosts:function(){const e=new URLSearchParams(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).toString();return r(`${n.Hr.SOCIAL}/posts?${e}`)}},g={getLeaderboard:function(){const e=new URLSearchParams(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).toString();return r(`${n.Hr.LEADERBOARD}?${e}`)}}}}]);